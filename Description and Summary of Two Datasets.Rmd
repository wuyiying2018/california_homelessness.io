---
title: "california_homelessness"
author: "Zilin Huang"
date: "2023-11-04"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(tidyverse)
library(usmap)

homeless_data <- read.csv("2019-2020-homeless-ip-and-ed-by-facility.csv")
age_clean <- read.csv("./processed data/demo/cleaned_age_demo.csv")
ethnicity_clean <- read.csv("./processed data/demo/cleaned_ethnicity_demo.csv")
gender_clean <- read.csv("./processed data/demo/cleaned_gender_demo.csv")
race_clean <- read.csv("./processed data/demo/cleaned_race_demo.csv")
```

For the purpose of analyzing the population trend of California's homelessness, we used the following datasets for our project: `2019-2020-homeless-ip-and-ed-by-facility.csv`, `cleaned_race_demo.csv`, `cleaned_gender_demo.csv`, `cleaned_ethnicity_demo.csv`, `cleaned_age_demo.csv`. Extracted from `HealthData.gov`, the official government-authorized website containing various public-health-related data sources, these datasets contain critical information of the summary of Californian homeless people stratified by race, gender, ethnicity, age, as well as those receiving hospitalizations or emergency department visits from 2019 to 2020. 

## Summary

To begin with the analysis process, we summarized the counts of Californian homeless people receiving appropriate health services from 2019 to 2020 of the `2019-2020-homeless-ip-and-ed-by-facility.csv` dataset:

```{r}
# define a function that automates the process of creating summary table,
# with the dataset's name as the input
summary_of_table <- function(df) {
  summary_table <- list()
  
  for (col in names(df)) {
      summary_by_col <- df |>
        group_by(!!sym(col)) |>
        summarise(Count = n()) |>
        mutate(Percentage = (Count / sum(Count)) * 100)
      
      summary_table[[col]] <- summary_by_col
  }

  return(summary_table)
}
```

```{r}
homeless_data_for_summary =
  homeless_data |>
  filter(HomelessIndicator == "Homeless") |>
  select(EncounterType, System, Ownership, Urban_Rural, LicensedBedSize, DemographicValue)

summary_of_table(homeless_data_for_summary)
```

The following commands summarize the counts and percentages of Californian homeless people from 2017 to 2023, stratified by age, ethnicity, gender, race, separately.

```{r}
age_clean_for_summary = 
  age_clean |>
  select(-experiencing_homelessness, -location)
summary_of_table(age_clean_for_summary)
```

```{r}
ethnicity_clean_for_summary = 
  ethnicity_clean |>
  select(-experiencing_homelessness, -location)
summary_of_table(ethnicity_clean_for_summary)
```

```{r}
gender_clean_for_summary = 
  gender_clean |>
  select(-experiencing_homelessness, -location)
summary_of_table(gender_clean_for_summary)
```

```{r}
race_clean_for_summary = 
  race_clean |>
  select(-experiencing_homelessness, -location)
summary_of_table(race_clean_for_summary)
```




